{{ 'newsletter.css' | asset_url | stylesheet_tag }}

<div class="newsletter-section">
  <div class="container">
    {%- if section.settings.heading != blank -%}
      <h2 class="newsletter-section__heading">{{ section.settings.heading }}</h2>
    {%- endif -%}

    {%- if section.settings.description != blank -%}
      <p class="newsletter-section__description">{{ section.settings.description }}</p>
    {%- endif -%}

    {%- assign newsletter_form_id = 'newsletter-form-' | append: section.id -%}

    {%- form 'customer', id: newsletter_form_id, class: 'newsletter-section__form' -%}
      {%- if form.posted_successfully? -%}
        <div class="newsletter-section__success">
          {{ 'general.newsletter.subscribed_successfully' | t }}
        </div>
      {%- else -%}
        {%- if form.errors -%}
          <div class="newsletter-section__error">
            {{ form.errors.translated_fields['email'] }} {{ form.errors.messages['email'] }}
          </div>
        {%- endif -%}

        <input type="hidden" name="contact[tags]" value="newsletter">

        <div class="newsletter-section__form-wrapper">
          <input
            type="email"
            name="contact[email]"
            id="{{ newsletter_form_id }}-email"
            class="newsletter-section__input"
            placeholder="{{ section.settings.placeholder_text | default: 'Enter your email' }}"
            required
            autocomplete="email"
            aria-label="{{ 'general.newsletter.email' | t }}"
          >
          <button type="submit" class="newsletter-section__button">
            {{ section.settings.button_text | default: 'Subscribe' }}
          </button>
        </div>
      {%- endif -%}
    {%- endform -%}
  </div>
</div>

{% schema %}
{
  "name": "Newsletter",
  "class": "shopify-section--newsletter",
  "tag": "section",
  "disabled_on": {
    "groups": ["header", "custom.overlay"]
  },
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Join the BeautyHeaven Club"
    },
    {
      "type": "text",
      "id": "description",
      "label": "Description",
      "default": "Exclusive offers and early access to new arrivals."
    },
    {
      "type": "text",
      "id": "placeholder_text",
      "label": "Email Placeholder Text",
      "default": "Enter your email"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Subscribe"
    }
  ],
  "presets": [
    {
      "name": "Newsletter",
      "category": "Marketing",
      "settings": {
        "heading": "Join the BeautyHeaven Club",
        "description": "Exclusive offers and early access to new arrivals.",
        "placeholder_text": "Enter your email",
        "button_text": "Subscribe"
      }
    }
  ]
}
{% endschema %}
